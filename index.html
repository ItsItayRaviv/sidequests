<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Toâ€‘Do App (Local)</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    h1 { margin-bottom: 10px; }
    .assignment { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
    .assignment h3 { margin: 0 0 5px 0; }
    form { margin-bottom: 20px; }
    form input, form textarea { display: block; margin: 6px 0; width: 300px; }
    .small { font-size: 0.9rem; color: #555; }
  </style>
</head>
<body>
  <h1>Assignments</h1>

  <form id="addForm">
    <input type="text" id="course" placeholder="Course" required />
    <input type="date" id="dueDate" required />
    <input type="number" id="estMinutes" placeholder="Estimated minutes" required />
    <input type="url" id="link" placeholder="Link (optional)" />
    <input type="text" id="filePath" placeholder="Local file path (optional)" />
    <textarea id="notes" placeholder="Description (optional)"></textarea>
    <button type="submit">Add Assignment</button>
  </form>

  <div id="list"></div>

  <script>
    const STORAGE_KEY = "assignments";

    function load() {
      try {
        return JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
      } catch {
        return [];
      }
    }

    function save(list) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
    }

    function render() {
      const list = load().sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));
      const container = document.getElementById("list");
      container.innerHTML = "";

      list.forEach((a, i) => {
        const div = document.createElement("div");
        div.className = "assignment";
        const daysLeft = Math.ceil((new Date(a.dueDate) - new Date()) / 86400000);
        div.innerHTML = `
          <h3>${a.course}</h3>
          <div class="small">Due: ${a.dueDate} (${daysLeft} days left)</div>
          <div class="small">Estimated: ${a.estMinutes} min</div>
          ${a.link ? `<a href="${a.link}" target="_blank">Open link</a>` : ""}
          ${a.filePath ? `<div class="small">File: ${a.filePath}</div>` : ""}
          ${a.notes ? `<p>${a.notes}</p>` : ""}
          <button onclick="removeItem(${i})">Delete</button>
        `;
        container.appendChild(div);
      });
    }

    function removeItem(i) {
      const list = load();
      list.splice(i, 1);
      save(list);
      render();
    }

    document.getElementById("addForm").addEventListener("submit", e => {
      e.preventDefault();
      const item = {
        course: course.value,
        dueDate: dueDate.value,
        estMinutes: estMinutes.value,
        link: link.value.trim(),
        filePath: filePath.value.trim(),
        notes: notes.value.trim()
      };
      const list = load();
      list.push(item);
      save(list);
      e.target.reset();
      render();
    });

    render();
  </script>
</body>
</html>
